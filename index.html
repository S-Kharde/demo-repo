<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>3D Rotating Donut</title>
  <style>
    body { background: black; color: white; }
    pre { font-family: monospace; font-size: 10px; line-height: 8px; }
  </style>
</head>
<body>
  <pre id="donut"></pre>

  <script>
    const pre = document.getElementById("donut");
    const width = 120, height = 40;
    const chars = ".,-~:;=!*#$@"; // symbols for brightness

    let A = 0, B = 0;

    function render() {
      let z = new Array(width * height).fill(0);
      let b = new Array(width * height).fill(" ");

      for (let j = 0; j < 6.28; j += 0.03) {      // finer step
        for (let i = 0; i < 6.28; i += 0.02) {
          let c = Math.sin(i), l = Math.cos(i);
          let d = Math.cos(j), f = Math.sin(j);
          let e = Math.sin(A), g = Math.cos(A);
          let m = Math.cos(B), n = Math.sin(B);

          let h = d + 2;                    // R1 + R2*cos(j)
          let D = 1 / (c * h * e + f * g + 5);
          let t = c * h * g - f * e;

          let x = Math.floor(width / 2 + width * 0.4 * D * (l * h * m - t * n));
          let y = Math.floor(height / 2 + height * 0.8 * D * (l * h * n + t * m));
          let o = x + width * y;

          let N = Math.floor(8 * ((f * e - c * d * g) * m - c * d * e - f * g - l * d * n));
          if (y >= 0 && y < height && x >= 0 && x < width && D > z[o]) {
            z[o] = D;
            b[o] = chars[Math.max(0, N)];
          }
        }
      }

      let output = "";
      for (let k = 0; k < b.length; k++) {
        output += b[k];
        if ((k + 1) % width === 0) output += "\n";
      }
      pre.textContent = output;

      A += 0.04;
      B += 0.02;
    }

    setInterval(render, 50);
  </script>
</body>
</html>
